# `feature-fetch`
> Status: Experimental

A straightforward, typesafe, and feature-based fetch wrapper.

### Motivation

Provide a typesafe, straightforward, and lightweight fetch wrapper that can be configured to pull in an OpenAPI schema using `openapi-typescript`. This ensures API calls are correct and returns results using [`ts-results-es`](https://github.com/lune-climate/ts-results-es#readme), making error handling easy and predictable.

### Alternatives

- [wretch](https://github.com/elbywan/wretch)
- [openapi-fetch](https://github.com/drwpow/openapi-typescript/tree/main/packages/openapi-fetch)

# ðŸ“– Usage

## `withApi()`

A typesafe fetch wrapper.

```ts
import { createApiFetchClient } from 'feature-fetch';

const fetchClient = createApiFetchClient({
  prefixUrl: 'https://api.example.com/v1'
});

const result = await fetchClient.get<{ id: string }>('/blogposts/{postId}', {
  pathParams: {
    postId: '123'
  }
});

// 2XX Response Codes
if (result.isOk()) {
  console.log(result.value.data);
}
// Error response or Network exception
else {
  console.log(result.error);
}

// Or get OK response and throw error
result.unwrap();

await fetchClient.put('/blogposts/', { id: '123', message: 'hello' });
```

## `withOpenApi()`

A typesafe fetch wrapper that pulls in your OpenAPI schema using [`openapi-typescript`](https://github.com/drwpow/openapi-typescript/tree/main).

```ts
import { createOpenApiFetchClient } from 'feature-fetch';
// Generated by 'openapi-typescript'
import { paths } from './openapi-paths';

const fetchClient = createOpenApiFetchClient<paths>({
  prefixUrl: 'https://api.example.com/v1'
});

const result = await fetchClient.get('/blogposts/{postId}', {
  pathParams: {
    postId: '123'
  }
});

// 2XX Response Codes
if (result.isOk()) {
  console.log(result.value.data);
}
// Error response or Network exception
else {
  console.log(result.error);
}

// Or get OK response and throw error
result.unwrap();

await fetchClient.put('/blogposts/', { id: '123', message: 'hello' });
```

## Features

### `withRetries()`

Retries a request multiple times in case of an error.

```ts
import { createApiFetchClient, withRetries } from 'feature-fetch';

const fetchClient = withRetries(createApiFetchClient({
  prefixUrl: 'https://api.example.com/v1'
}), {
  maxRetries: 10
});
```
